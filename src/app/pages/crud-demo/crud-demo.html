<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4">
  <div class="max-w-full mx-auto">
    <!-- HEADER -->
    <div class="mb-12">
      <h1 class="text-3xl md:text-4xl text-center font-bold text-gray-900 dark:text-white mb-2">
        Reseñas de Películas
      </h1>
      <p class="text-center text-base text-gray-600 dark:text-gray-400">
        Comparte tu opinión sobre tus películas favoritas
      </p>
    </div>

    <!-- ERROR MESSAGE -->
    <div *ngIf="error()" class="mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-4 rounded-xl">
      <p class="text-red-700 dark:text-red-300 text-sm">{{ error() }}</p>
    </div>

    <!-- FORMULARIO -->
    <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 md:p-8 mb-10 border border-gray-200 dark:border-gray-700">
      <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">
        {{ editingId() ? 'Editar Reseña' : 'Nueva Reseña' }}
      </h2>
      
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-5">
          <!-- TÍTULO -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              Título
            </label>
            <input
              type="text"
              formControlName="title"
              class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 px-4 py-2.5 text-gray-900 dark:text-gray-100 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-1 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors"
              placeholder="Ej: Blade Runner 2049"
            />
            <p class="text-xs text-red-600 dark:text-red-400 mt-1.5" *ngIf="form.get('title')?.touched && form.get('title')?.invalid">
              El título es obligatorio (máx. 30 caracteres)
            </p>
          </div>

          <!-- PUNTUACIÓN -->
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              Puntuación
            </label>
            <select
              formControlName="rating"
              class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 px-4 py-2.5 text-gray-900 dark:text-gray-100 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-1 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors"
            >
              <option value="1">⭐ 1/5</option>
              <option value="2">⭐⭐ 2/5</option>
              <option value="3">⭐⭐⭐ 3/5</option>
              <option value="4">⭐⭐⭐⭐ 4/5</option>
              <option value="5" selected>⭐⭐⭐⭐⭐ 5/5</option>
            </select>
          </div>
        </div>

        <!-- RESEÑA -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
            Reseña
          </label>
          <textarea
            rows="3"
            formControlName="review"
            class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 px-4 py-2.5 text-gray-900 dark:text-gray-100 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-1 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors resize-none"
            placeholder="Comparte tu opinión..."
          ></textarea>
          <p class="text-xs text-red-600 dark:text-red-400 mt-1.5" *ngIf="form.get('review')?.touched && form.get('review')?.invalid">
            La reseña es obligatoria (máx. 240 caracteres)
          </p>
        </div>

        <!-- BOTONES -->
        <div class="flex gap-3">
          <button
            type="submit"
            [disabled]="submitting() || form.invalid"
            class="flex-1 px-6 py-2.5 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 dark:disabled:bg-gray-600 transition-colors disabled:cursor-not-allowed"
          >
            <span *ngIf="!submitting() && !editingId()">Publicar</span>
            <span *ngIf="!submitting() && editingId()">Guardar</span>
            <span *ngIf="submitting()">Guardando...</span>
          </button>
          
          <button
            type="button"
            *ngIf="editingId()"
            (click)="cancelEdit()"
            class="px-6 py-2.5 rounded-lg font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
          >
            Cancelar
          </button>
        </div>
      </form>
    </div>

    <!-- LOADING STATE -->
    <div *ngIf="loading()" class="text-center py-16">
      <div class="inline-block animate-spin rounded-full h-10 w-10 border-2 border-gray-300 dark:border-gray-700 border-t-blue-600"></div>
      <p class="text-gray-500 dark:text-gray-400 mt-3 text-sm">Cargando...</p>
    </div>

    <!-- LISTADO DE RESEÑAS -->
    <div *ngIf="!loading()">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-xl font-semibold text-gray-900 dark:text-white">
          Reseñas ({{ reviews().length }})
        </h2>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
        <div 
          *ngFor="let review of reviews()" 
          class="bg-white dark:bg-gray-800 rounded-xl p-5 border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-colors"
        >
          <div class="flex items-start justify-between mb-3">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex-1 pr-2">
              {{ review.title }}
            </h3>
            <div class="flex gap-1">
              <button
                type="button"
                (click)="onEdit(review); $event.stopPropagation()"
                class="text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-sm"
                title="Editar"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </button>
              <button
                type="button"
                (click)="onDelete(review.id, review.title); $event.stopPropagation()"
                class="text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded-lg p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-sm"
                title="Eliminar"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
              </button>
            </div>
          </div>
          
          <div class="flex items-center gap-2 mb-3">
            <div class="text-yellow-500 text-base">
              {{ '⭐'.repeat(+review.rating) }}
            </div>
            <span class="text-xs text-gray-500 dark:text-gray-400">
              {{ review.rating }}/5
            </span>
          </div>
          
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed mb-4">
            {{ review.review }}
          </p>
          
          <div class="flex items-center gap-1.5 text-xs text-gray-400 dark:text-gray-500 pt-3 border-t border-gray-100 dark:border-gray-700">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <span>{{ review.date | date:'short' }}</span>
          </div>
        </div>

        <!-- EMPTY STATE -->
        <div 
          *ngIf="reviews().length === 0" 
          class="col-span-full text-center py-20 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-dashed border-gray-300 dark:border-gray-700"
        >
          <svg class="w-16 h-16 mx-auto mb-4 text-gray-400 dark:text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
          </svg>
          <p class="text-lg font-medium text-gray-900 dark:text-white mb-1">
            No hay reseñas
          </p>
          <p class="text-sm text-gray-500 dark:text-gray-400">
            Sé el primero en compartir tu opinión
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
